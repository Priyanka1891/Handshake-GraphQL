(function(){var k=PaymentsPortal2.modules.define;P.when("A").execute(function(c){var b=c.state("apx")||{};if(!b.apxSecondaryViewRegistered){var f=c.$(window);c.declarative("apx-secondary-view","click",function(b){if(b.data.widgetInstanceId){var a=b.data.widgetInstanceId,d=b.data.id||1,h=b.data.header,q=b.data.backButtonText||"Back",l=b.data.hideHeader||!1,n=b.data.alternateBackground||!1,r=b.data.paddingClass||"",w=b.data.inlineContent||b.data.content,g=".pmts-portal-root-"+a,m=".apx-secondary-view-root-"+
a,s="#apx-secondary-view-"+d,x=f.scrollTop(),k=b.$target.closest(g).last();k.hide();g=c.$(m).last();g.length||(k.after('<div class="apx-secondary-view-root-'+a+' pmts-portal-component"></div>'),g=c.$(m));var u=g.find(s);u.remove();m=h?['<div class="a-span8 a-column a-span-last a-text-right">','<h4 id="apx-secondary-view-header-'+d+'">',h,"</h4>\n</div>"].join("\n"):"";g.append(['<div class="a-popover a-popover-secondary a-declarative" data-action="a-popover-a11y" id="apx-secondary-view-'+d+'">','<div class="a-popover-wrapper">',
'<div class="a-popover-header-secondary'+(l?" a-popover-no-header":"")+'">','<div class="a-row">','<div class="'+(h?"a-span4":"a-span12 a-span-last")+' a-column">','<a class="a-declarative" data-action="apx-secondary-view-close"  href="#" data-apx-secondary-view-close="{&quot;widgetInstanceId&quot;:&quot;'+a+"&quot;, &quot;scrollTop&quot;:"+x+", &quot;id&quot;:&quot;"+d+'&quot;}">','<i class="a-icon a-icon-page-back"></i>\n<h4>',q||"Back","</h4>\n</a>\n</div>",m,"</div>\n</div>",'<div class="a-popover-inner'+
(n?" a-color-alternate-background":"")+'">','<div class="a-popover-header-spacing'+(l?" a-popover-no-header":"")+'"></div>','<div class="a-container a-secondary-view-inner'+r+'" id="apx-secondary-view-content-'+d+'">',w,"</div>\n</div>\n</div>\n</div>"].join("\n"));u=g.find(s);a=function(){var d=c.viewport();u.width(d.width);u.css("min-height",d.height);u.find(".a-popover-wrapper, .a-popover-inner").css("min-height",d.height)};a();c.on("resize",a);u.show().css("visibility","visible").removeClass("a-popover-hidden");
f.scrollTop(0)}b.$event.preventDefault()});c.declarative("apx-secondary-view-close","click",function(b){var a=b.data.widgetInstanceId,d=b.data.id,h=b.data.scrollTop;a&&d&&(d=b.$target.closest("#apx-secondary-view-"+d).last(),a=c.$(".pmts-portal-root-"+a),d.remove(),a.show(),h&&f.scrollTop(h));b.$event.preventDefault()});b.apxSecondaryViewRegistered=!0;c.state("apx",b)}});k("attributes",["lang","events"],function(c,b){return c.extend({},b,{attributes:{},resetQuietly:function(b){this.attributes={};
if(null!=b)for(var c in b){var a=b[c];void 0!==a&&(this.attributes[c]=a)}},toJSON:function(){return c.clone(this.attributes)},get:function(b){if(c.has(this.attributes,b))return this.attributes[b]},has:function(b){return void 0!==this.get(b)},set:function(b,e){var a;c.isString(b)?(a={},a[b]=e):a=b;var d,h,q,l;for(l in a)h=a[l],q=this.get(l),this.isAttributeEqual(l,q,h)||(d||(d={}),d[l]=q,void 0!==h?this.attributes[l]=h:delete this.attributes[l]);if(d){for(var n in d)c.has(d,n)&&(h=this.get(n),q=d[n],
this.trigger("change:"+n,h,n,this,q));this.trigger("change",this)}},unset:function(){var b={};if(0===arguments.length)for(var e in this.attributes)c.has(this.attributes,e)&&(b[e]=void 0);else c.forEach(arguments,function(a){b[a]=void 0});return this.set(b)},reset:function(b){var e={},a;for(a in this.attributes)c.has(this.attributes,a)&&(e[a]=void 0);null!=b&&c.extend(e,b);return this.set(e)},isAttributeEqual:function(b,c,a){return c===a},watch:function(){var b,c,a,d;if(2===arguments.length)for(b in a=
arguments[0],c=arguments[1],c)d=c[b],this.on("change:"+b,a,d);else b=arguments[0],a=arguments[1],d=arguments[2],this.on("change:"+b,a,d);return this}})});k("aui-helper",["jQuery","lang","css-utils","AUI!P"],function(c,b,f,e){return{_dropdown:function(a){return{getControlElement:function(){return this._getSpan().prev()},_getSpan:function(){return a},error:function(d){var a=this._getSpan();if("undefined"!==typeof d)a.toggleClass("a-form-error a-button-error",d);else return a.hasClass("a-button-error")||
a.hasClass("a-form-error")},val:function(d){var a=this.getControlElement(),b=this._getSpan();if("undefined"!==typeof d)e.when("a-dropdown").execute(function(e){var f=a.attr("id");c.isFunction(e.getSelect)?e.getSelect(f).setValue(d):(a.val(d),c(b.find(".a-dropdown-prompt")[0]).html(d))});else return a.val()},getOptionTextForValue:function(d){var a=this.getControlElement();return a?a.find("[value="+d+"]").first().text():""},toggleDisabled:function(d){if(e){var a=this._getSpan(),b=this.getControlElement();
"undefined"===typeof d&&(d=!f.hasAUIDisabledButtonClass(b));e.when("a-dropdown").execute(function(e){var n=b.attr("id"),r=d?"disabled":"normal";c.isFunction(e.getSelect)?e.getSelect(n).update({status:r}):f.toggleDisabledElement(a,!d)})}},isEnabled:function(){return!f.hasAUIDisabledButtonClass(this._getSpan())}}},_radio:function(a,d){var b=a.getDOMElementsByPrefix(d+"-");return{getControlElement:function(){return b},error:function(d){},val:function(d){if("undefined"!==typeof d){var a=b.filter(function(a,
b){return b.value===d})[0];a&&(a.checked=!0)}else return b.filter(":checked").val()},isEnabled:function(){return!this.getControlElement().prop("disabled")},isChecked:function(){return this.getControlElement()[0].checked}}},_textInput:function(a,d){return{getControlElement:function(){return a},getParent:function(){return a.parent()},error:function(d){var a=this.getParent(),a=a.hasClass("a-input-text-wrapper")?a:this.getControlElement();if("undefined"!==typeof d)a.toggleClass("a-form-error",d);else return a.hasClass("a-form-error")},
val:function(d){if("undefined"!==typeof d)a.val(d);else return a.val()},isEnabled:function(){return!a.hasClass("a-form-disabled")}}},_generic:function(a){return{getControlElement:function(){return a},error:function(d){if("undefined"!==typeof d)a.toggleClass("a-form-error",d);else return a.hasClass("a-form-error")},val:function(d){if("undefined"!==typeof d)a.val(d);else return a.val()},isEnabled:function(){return!a.hasClass("a-form-disabled")}}},getAUITagHelper:function(a,d){switch(a.getElementTagType(d)){case "RadioButtonTag":return this._radio(a,
d);case "DropdownTag":return this._dropdown(a.getDOMElement(d));case "TextInputTag":return this._textInput(a.getDOMElement(d));default:return this._generic(a.getDOMElement(d))}},getFormAlertsContainerHelper:function(a,d){return{render:function(b){b&&b.length&&0<b.length?("inline"===a?this._renderInlineAlerts(b):this._renderBoxAlerts(b),f.showElement(d)):(c(d.find("ul")).empty(),f.hideElement(d))},_renderInlineAlerts:function(a){d.find(".pmts-error-message-inline").remove();var c=d.find(".pmts-error-message-inline-template");
b.forEach(a,function(a){var b=c.clone().removeClass("pmts-error-message-inline-template").addClass("pmts-error-message-inline");b.find("p").text(a.localizedMessageString);b.appendTo(d)})},_renderBoxAlerts:function(a){var e=c(d.find("ul")).empty();b.forEach(a,function(d){c("<span>").attr("class","a-list-item").text(d.localizedMessageString).appendTo(c("<li>").appendTo(e))})}}},dynamicTriggeredWidgetEvent:function(a){var d=c("form"),b=document.createElement("input");b.name="ppw-widgetEvent:"+a;b.type=
"hidden";d.append(b);d.submit()},getExpanderHelper:function(a){var d;return{isExpanded:function(){return"true"===this.getContainer().find("div.a-expander-inline-content").attr("aria-expanded")},getContainer:function(){return d||(d=a.closest("div.a-expander-inline-container"))}}}}});(function(){var c=null;"undefined"!==typeof AmazonUIPageJS?c=AmazonUIPageJS:"undefined"!==typeof P&&(c=P);c?(k("AUI!P",[],function(){return c}),c.when("A").execute(function(b){k("AUI!A",[],function(){return b})})):(k("AUI!P",
[],function(){return null}),k("AUI!A",[],function(){return null}))})();k("base",["lang"],function(c){function b(a,d){return function(){a.apply(this,arguments);d.apply(this,arguments)}}function f(a,d){for(var h=d.length-1;0<=h;h--){var e=d[h];if(c.has(e,"constructor"))return e.constructor;if(c.has(e,"initialize"))return 0<h&&(a=f(a,c.slice(d,0,h))),b(a,e.initialize)}return function(){a.apply(this,arguments)}}var e=function(){};e.extend=function(){var a=f(this,arguments);a.extend=this.extend;a.prototype=
c.create(this.prototype);a.prototype.constructor=a;for(var d=0,b=arguments.length;d<b;d++){var e=arguments[d],l;for(l in e)c.has(e,l)&&"constructor"!==l&&"initialize"!==l&&(a.prototype[l]=e[l])}return a};return e});k("cc-spacing",[],function(){return{fixSpacing:function(c){c=c.replace(/\s/g,"");0<c.length&&(c=c.match(/^3[47]/)?[c.substr(0,4),c.substr(4,6),c.substr(10,5),c.substr(15)].join(" ").trim():c.match(RegExp(".{1,4}","g")).join(" "));return c},fixCaret:function(c,b,f,e){if(b&&f)if(b.length===
f.length+2){if(e===f.length||" "===f.charAt(e))c+=1}else b.length===f.length+1&&e<f.length&&" "===f.charAt(e)&&(c+=1);return c}}});k("component",["base","jQuery","lang","aui-helper","AUI!P"],function(c,b,f,e,a){return c.extend({initialize:function(d,a){this.id=a.id;this.widget=d;this._elementReferences=a.elementReferences;this._elementDOMEventMethodBindings=a.elementDOMEventMethodBindings;this._elementReferenceTagType=a.elementReferenceTagType;this.data=a.data},initializeOnReady:function(){this.bindToEvents();
this._processDOMElementEventMethodBindings();this.bindToElements();this._handleScrollToPosition(this.data);this._setFocusOnElement(this.data)},_processDOMElementEventMethodBindings:function(){var d=this;d._elementDOMEventMethodBindings&&f.forEach(d._elementDOMEventMethodBindings,function(a){if(a.method in d)b("#"+a.elementId).bind(a.event,f.bind(d[a.method],d));else throw Error("Could not find method "+a.method+" on component.");})},getDOMElement:function(a){a=this._elementReferences[a];var h=b("#"+
a);return a&&1===h.length?h:b([])},getDOMElements:function(){var a=b([]);f.forEach(f.keys(this._elementReferences),function(b){a=a.add(this.getDOMElement(b))},this);return a},getDOMElementsByPrefix:function(a){var h=b([]);f.forEach(f.keys(this._elementReferences),function(b){f.startsWith(b,a)&&(h=h.add(this.getDOMElement(b)))},this);return h},getElementTagType:function(a){return this._elementReferenceTagType[a]},_setFocusOnElement:function(a){void 0!==a&&void 0!==a.focusElementIdReference&&this.widget.focusToElement(this._elementReferences[a.focusElementIdReference])},
_handleScrollToPosition:function(a){void 0!==a&&void 0!==a.scrollOption&&("toElementByReference"===a.scrollOption?this.widget.scrollToElementOnInitialize(this._elementReferences[a.scrollElementIdReference]):"toTopOfThePage"===a.scrollOption&&this.widget.scrollToTopOfThePage())},bindToElements:function(){},bindToEvents:function(){},onExpanderClick:function(a){a=b(a.currentTarget);a=e.getExpanderHelper(a);var h=a.getContainer();if(h.length&&!a.isExpanded()){this.widget.scrollToElement(h);var c=h.find("input[type='text'], input[type='tel']").first();
window.setTimeout(function(){c.focus()},150)}},detach:function(){var a=this;f.forEach(f.keys(a._elementReferences),function(b){a.getDOMElement(b).unbind()})},getRootDOMElements:function(){return b(".pmts-portal-components-"+this.id)},widgetState:null,getWidgetState:function(a){this.widgetState||(this.widgetState=this.getDOMElement(a).closest("form").find("input[name=ppw-widgetState]").val());return this.widgetState},isWidgetRootComponent:function(){return this.getRootDOMElements().is(this.widget.getRootDOMElements())},
registerSecondaryView:function(b){var h=this,c=this.widget,e=this.getDOMElement(b);a.when("a-secondary-view").execute(function(a){if(a=a.get(e)){var f={instance:a,reference:b};h.secondaryViews=h.secondaryViews||[];h.secondaryViews.push(f);b===c.get("activeSecondaryViewReference")&&a.show()}});a.when("a-popover-util").execute(function(a){h.popoverUtilModule=a});c.on("widget:clean",this,function(){c.unset("activeSecondaryViewReference");h.popoverUtilModule&&h.secondaryViews&&f.forEach(h.secondaryViews,
function(a){var b=a.instance;b.isActive()&&(b.unlock().hide(),h.popoverUtilModule.trigger("dismiss",b),c.set("activeSecondaryViewReference",a.reference))})})}})});k("config",[],function(){var c={useNativeFunctions:!0,useNativeHasOwnProperty:!0};return{getAttribute:function(b){var f=("undefined"!==typeof window.APXConfig?window.APXConfig:"undefined"!==typeof window.PaymentsPortal2Config?window.PaymentsPortal2Config:{})[b];return"undefined"!==typeof f?f:c[b]}}});k("continuable-component",["component",
"continuable","clog","public-event-registry"],function(c,b,f,e){return c.extend(b,{CONTINUABLE_EVENT_NAME:"WidgetContinuableStatusEvent",initialize:function(a,b){e.register(this.CONTINUABLE_EVENT_NAME);this.fireWidgetContinuableStatusEvent=b.data.fireWidgetContinuableStatusEvent;this._watchContinuable()},_watchContinuable:function(){var a=this;this.watchContinuable(this,function(b){var c={widgetName:a.widget.type,isContinuable:b};a.widget.log(c);a.fireWidgetContinuableStatusEvent&&"undefined"!==typeof b&&
a.widget.trigger(this.CONTINUABLE_EVENT_NAME,c)})}})});k("continuable",["lang","attributes"],function(c,b){return c.extend({},b,{setContinuable:function(b){this.set("ContinuableAttribute",b)},getContinuable:function(){return this.get("ContinuableAttribute")},watchContinuable:function(){var b,c;2===arguments.length?(b=arguments[0],c=arguments[1]):(b=this,c=arguments[0]);this.watch("ContinuableAttribute",b,c)}})});k("css-utils",[],function(){var c=function(a){a.addClass("a-hidden aok-hidden");a.hide()},
b=function(a){a.removeClass("a-hidden aok-hidden");a.show()},f=function(a){a.addClass("a-button-disabled")},e=function(a){a.removeClass("a-button-disabled")},a=function(a){return a.hasClass("a-hidden")||a.hasClass("aok-hidden")},d=function(a){return a.hasClass("a-button-disabled")};return{hideElement:c,showElement:b,toggleElement:function(d,e){"undefined"===typeof e&&(e=a(d));e?b(d):c(d)},hasAUIHiddenClass:a,hasAUIDisabledButtonClass:d,disableElement:f,enableElement:e,toggleDisabledElement:function(a,
b){"undefined"===typeof b&&(b=d(a));b?e(a):f(a)},disableTextInput:function(a){a.addClass("a-form-disabled");a.prop("disabled",!0)},enableTextInput:function(a){a.removeClass("a-form-disabled");a.prop("disabled",!1)},makeTextInputReadOnly:function(a){a.addClass("a-form-disabled");a.prop("readonly",!0)},makeTextInputReadWrite:function(a){a.removeClass("a-form-disabled");a.prop("readonly",!1)},isTextInputReadOnly:function(a){return a.hasClass("a-form-disabled")&&a.is("[readonly]")},setElementBackgroundImage:function(a,
b,d){d?a.css("background","url('"+b+"')"+d):a.css("background-image","url('"+b+"')")}}});k("mixins/disable-component",["lang"],function(c){return c.extend({},{_disabled:!1,toggleDisabled:function(){this.setDisabled(!this._disabled)},isDisabled:function(){return this._disabled},setDisabled:function(b){arguments.length||(b=!0);if(b!==this._disabled){this._disabled=b;var c=this.getDOMElements();b?(c.find("input").andSelf().filter("input").prop("disabled",!0),c.find("span.a-color-base").removeClass("a-color-base").addClass("a-color-tertiary")):
(c.find("input").andSelf().filter("input").prop("disabled",!1),c.find("span.a-color-tertiary").removeClass("a-color-tertiary").addClass("a-color-base"));this.onDisabledChange(b)}},onDisabledChange:function(b){}})});k("events",["lang","AUI!A"],function(c,b){function f(b,a){c.every(b,function(b){return b.callback.apply(b.thisArg,a)!==PaymentsPortal2.events.STOP_EVENT_PROCESSING},this)}"undefined"===typeof PaymentsPortal2.events&&(PaymentsPortal2.events={},PaymentsPortal2.events.STOP_EVENT_PROCESSING=
"STOP_EVENT_PROCESSING");return{on:function(){var b,a,d;if(2===arguments.length){a=arguments[0];var h=arguments[1];for(b in h)d=h[b],this.on(b,a,d);return this}b=arguments[0];a=arguments[1];d=arguments[2];if(null==a)throw new TypeError("Events.on: thisArg must not be null or undefined");if(!c.isFunction(d))throw new TypeError("Events.on: callback must be a function");h=this.listeners;h||(h=this.listeners={});c.has(h,b)||(h[b]=[]);h[b].push({callback:d,thisArg:a});return this},auiListeners:{},onAui:function(c,
a){b&&(this.auiListeners[c]=this.auiListeners[c]||[],this.auiListeners[c].push(a),b.on(c,a))},offAui:function(e,a){if(b)if(null==e){for(var d in this.auiListeners)this.auiListeners.hasOwnProperty(d)&&c.forEach(this.auiListeners[d],function(a){b.off(d,a)});this.auiListeners={}}else b.off(e,a)},off:function(b,a,d){if(null==b&&null==a&&null==d)return delete this.listeners,this;var h=this.listeners;if(!h)return this;b=null==b?c.keys(h):[b];c.forEach(b,function(b){c.has(h,b)&&(h[b]=c.filter(h[b],function(b){return null!=
a&&a!==b.thisArg&&a!==b.thisArg.widget||null!=d&&d!==b.callback}))});return this},trigger:function(b){var a=this.listeners;if(!a)return this;var d=c.slice(arguments,1);c.has(a,"all")&&f.call(this,a.all,c.merge([b],d));c.has(a,b)&&f.call(this,a[b],d);return this},triggerContinue:function(b,a){a&&a.submissionParameters&&a.submissionParameters.push({name:"ppw-jsEnabled",value:!0});this.trigger(b,a)}}});k("events/form-submitted-event",[],function(){return"FormSubmitted"});k("events/spinner-events",[],
function(){return{hideSpinner:"HideSpinner",showSpinner:"ShowSpinner"}});k("events/workflow-state-event",[],function(){return"WorkflowState"});k("form-component",["component","form","keyboard","lang"],function(c,b,f,e){return c.extend({initialize:function(a,d){this.form=new b(this,d.data.formQualifier,d.data.formDefinition)},bindFormSubmissionHandler:function(a,b,c){var q=this;q.getDOMElement(a).click(e.bind(c,q));q.getDOMElement(b).bind("keypress",function(a){if(a.which===f.keys.VK_RETURN)return c.call(q)})},
getFormSubmissionParameters:function(a,b){var c="string"===typeof a?this.getDOMElement(a):a,e=c.find("form").andSelf().filter("form"),e=0!==e.length?e.serializeArray():c.find("input, select").serializeArray(),c=1<arguments.length?("string"===typeof b?this.getDOMElement(b):b).find("input[type=submit]").attr("name"):c.find("input[type=submit]")[0].name;e.push({name:c,value:"Submit"});return e}})});k("form-constants",[],function(){return{WIDGET_EVENT_KEY:"ppw-widgetEvent",KEY_VALUE_SEPARATOR:":"}});
k("form-helper",["lang","jQuery","form-constants"],function(c,b,f){return{onSubmit:function(c,a){c.each(function(){var d=b(this),c=null;d.find("input[type=submit]").click(function(a){c=b(a.target)});d.submit(function(b){a(d,b,c);c=null})})},serializeObject:function(b){return c.reduce(b.serializeArray(),function(a,b){a[b.name]=b.value;return a},{})},ensureWidgetEventInput:function(b,a){var d=f.WIDGET_EVENT_KEY+f.KEY_VALUE_SEPARATOR,h=c.startsWith(a,d)?a:d+a,q=function(){return b.find("input[type='hidden'][name^='"+
d+"']")};q().not("[name^='"+h+"']'").remove();q().length||b.append("<input name="+h+" type=hidden />")}}});k("form-model",["base","lang","validation-functions"],function(c,b,f){return c.extend({initialize:function(b){this.constraints=b.constraints;this.fields=b.fields;this.validationEvent=b.validationEvent;this.actionEvent=b.actionEvent;this.additionalData={}},validateForm:function(c){var a={},d=[];b.forEach(this.constraints,function(b){if(!a[b.field]&&!this.evalValidator(b,c)){a[b.field]=!0;var f=
{field:b.field,validation:b.validation,messageStringId:b.failureMessageStringId};this.validationEvent&&this.actionEvent&&(f.fieldMetricValueType=b.metricValueType,f.fieldValue=this._getFieldValue(b,c));d.push(f)}},this);return d},_getFieldValue:function(b,a){var d="CRITICAL_OR_RESTRICTED_VALUE";if(!b.isCriticalOrRestricted)if(d=this.fields[b.field],"expirationDate"===b.field)var c=a[d.dayParameterName],d=a[d.yearParameterName]+"-"+a[d.monthParameterName]+"-"+("undefined"===typeof c?"01":c);else d=
a[d.defaultParameterName];return d},evalValidator:function(b,a){var d=f[b.validation];return d?d.call(null,this,a,this.fields[b.field],b.parameters):!0},registerAdditionalData:function(b,a){"string"===typeof b&&(this.additionalData[b]=a)},getAdditionalData:function(b){return this.additionalData[b]}})});k("form","base css-utils lang jQuery form-model aui-helper".split(" "),function(c,b,f,e,a,d){var h=[/^addCreditCardVerificationNumber[0-9]*$/];return c.extend({initialize:function(b,d,c){this.component=
b;this.formQualifier=d;this.formModel=new a(c);this.fields=c.fields},validateForm:function(a){this.clearValidationErrors();var b=this.getFormValues(),b=this._getLocalizedErrorMessages(this.formModel.validateForm(b));0<b.length&&!a&&this.renderErrorMessages(b);return b},renderErrorMessages:function(a){var b=this,c=[],e=[],h=[],g={};f.forEach(a,function(a){a.field&&(g[a.field]||(g[a.field]=[]),g[a.field].push(a),b.blameFormField(a.field,!0));a.validation&&a.fieldMetricValueType&&a.fieldValue&&(c.push(a.validation),
e.push(a.fieldMetricValueType),h.push(a.fieldValue))});var m=this._getFormFieldAlertContainers();f.forEach(f.keys(m),function(a){d.getFormAlertsContainerHelper("inline",m[a]).render(g[a])});var s=this._getFormAlertsContainer();void 0!==s.domElement&&d.getFormAlertsContainerHelper(s.messageDisplayType,s.domElement).render(a)},_submitValidationMetrics:function(a,b,d){a&&b&&d&&this.component.widget.continueRequest({"ppw-widgetEvent":this.formModel.validationEvent,"ppw-actionEvent":this.formModel.actionEvent,
"ppw-validations":a,"ppw-valueTypes":b,"ppw-values":d,"ppw-widgetState":this.component.widget.options.serializedState},{success:function(){}})},_getFormAlertsContainer:function(){var a=this.component.getDOMElement("errorMessagesBoxContainer");return 0<a.length?{domElement:a,messageDisplayType:"box"}:{domElement:this.component.getDOMElement("errorMessagesInlineContainer"),messageDisplayType:"inline"}},_getFormFieldAlertContainers:function(){var a=this,b={};f.forEach(f.keys(this.fields),function(d){var c=
a.component.getDOMElement("errorMessagesInlineContainer-"+d);c.length&&(b[d]=c)});return b},_getLocalizedErrorMessages:function(a){var b=this;return f.map(a,function(a){return{field:a.field,validation:a.validation,fieldMetricValueType:a.fieldMetricValueType,fieldValue:a.fieldValue,messageStringId:a.messageStringId,localizedMessageString:b.component.widget.getLocalizedString(a.messageStringId)}})},getFormValues:function(){var a={},b=this;f.forEach(this._getParameterNames(),function(d){b.getAUITagHelperForParameter(d).isEnabled()&&
(a[d]=b.getAUITagHelperForParameter(d).val())});a.widgetCreationEpochMilliseconds=this.component.widget.widgetCreationEpochMilliseconds;return a},getQualifiedParameterName:function(a){if(this.formQualifier){var b=!1;h.forEach(function(d){b=b||d.test(a)});return b?a:this.formQualifier+"_"+a}return a},getAUITagHelperForParameter:function(a){return d.getAUITagHelper(this.component,this.getQualifiedParameterName(a))},bindToParameter:function(a,b){var d=[];Array.prototype.push.apply(d,arguments);d.shift();
var c=this.getAUITagHelperForParameter(a).getControlElement();c.bind.apply(c,d)},_getParameterNames:function(a){if(a){var b=this.fields[a];return f.map(f.keys(b),function(a){return b[a]})}var d=[],c=this;f.forEach(f.keys(this.fields),function(a){var b=c.fields[a];a=f.keys(b);f.forEach(a,function(a){d.push(b[a])})});return d},blameFormField:function(a,b){var d=this,c=this._getParameterNames(a);f.forEach(c,function(a){d.getAUITagHelperForParameter(a).error(b)})},resetErrors:function(){this.clearValidationErrors();
b.hideElement(this.component.getDOMElement("errorMessagesBoxContainer"))},clearValidationErrors:function(){var a=this;f.forEach(f.keys(this.fields),function(b){a.blameFormField(b,!1)})},displayErrorMessage:function(a,d){this.blameFormField(a,!0);b.showElement(d)},resetErrorMessage:function(a,d){this.blameFormField(a,!1);b.hideElement(d)}})});k("global-event-bus",["lang","events"],function(c,b){return c.extend({},b)});PaymentsPortal2.modules.when(["AUI!P"],function(c){function b(b){k("jQuery",[],function(){return b})}
c?c.when("jQuery").execute(b):"undefined"!==typeof jQuery&&b(jQuery)});k("keyboard",[],function(){return{keys:{VK_BACKSPACE:8,VK_RETURN:13,VK_DELETE:46,VK_ZERO:48,VK_NINE:57}}});k("lang",["config"],function(c){var b={id:function(a){return a}},f=Array.prototype.slice,e=Object.prototype.toString;b.slice=function(a){return f.apply(a,f.call(arguments,1))};b.isDefined=function(a){return!("undefined"===typeof a||null===a)};var a=b.isObject=function(a){return Object(a)===a},d=b.isFunction=function(a){return"[object Function]"===
e.call(a)},h=b.isString=function(a){return"[object String]"===e.call(a)};b.isNumber=function(a){return"[object Number]"===e.call(a)};var q=b.extend=function(a){a=Object(a);for(var b=1,d=arguments.length;b<d;b++){var c=arguments[b],g;for(g in c)a[g]=c[g]}return a};b.clone=function(a){return q({},a)};b.merge=function(a){for(var b=1,d=arguments.length;b<d;b++)for(var c=arguments[b],g=0,m=c.length;g<m;g++)a.push(c[g]);return a};b.force=function(a,b){var c=a[b];return d(c)?c.call(a):c};b.time=function(){return(new Date).getTime()};
b.date=function(){return new Date(b.time())};b.intercept=function(a,b,d,c){var g=a[b];a[b]=function(){d.apply(c,arguments);g&&g.apply(this,arguments)};return a};b.NOOP=function(){};b.forEachKeyValue=function(a,b){for(var d in a)r(a,d)&&b(d,a[d])};var l=0;b.newLocalId=function(){return"pmts-id-"+ ++l};b.assert=function(a,b){if(!a)throw Error(b||"Assertion Error");};b.once=function(a){var b=!1,d;return function(){if(b)return d;d=a.apply(this,arguments);b=!0;return d}};b.after=function(a,b){return function(){if(0>=
--a)return b.apply(this,arguments)}};b.leftPad=function(a,b,d){a=String(a);b-=a.length;return 0>=b?a:Array(b+1).join(d)+a};b.endsWith=function(a,b){return-1!==a.indexOf(b,a.length-b.length)};b.startsWith=function(a,b){return a.substr(0,b.length)===b};b.keywordFormat=function(a,b){return a.replace(/\{(\w+)\}/g,function(a,d){return"undefined"!==typeof b[d]?b[d]:a})};b.stableSort=function(a,b){var d=y(a,function(a,b){return{index:b,elem:a}});d.sort(function(a,d){var c=b(a.elem,d.elem);return 0===c?a.index-
d.index:c});return y(d,function(a){return a.elem})};var n=c.getAttribute("useNativeFunctions");c=c.getAttribute("useNativeHasOwnProperty");var r,w=Object.prototype.hasOwnProperty;r=w&&c?function(a,b){return w.call(a,b)}:function(a,b){if(!(b in a))return!1;for(var d in a)if(d===b)return!0;return!1};b.has=r;c=Array.isArray;b.isArray=c&&n?c:function(a){return"[object Array]"===e.call(a)};var g;if((c=Object.create)&&n)g=c;else{var m=function(){},s=m.prototype;g=function(b){if(null===b)throw Error("null prototypes are not supported");
if(!a(b))throw new TypeError("prototype must be an object");if(1<arguments.length)throw Error("property descriptors are not supported");m.prototype=b;var d=new m;m.prototype=s;return d}}b.create=g;var x=Function.prototype.bind;b.bind=x&&n?function(a){return x.apply(a,f.call(arguments,1))}:function(b,d){var c=f.call(arguments,2),m=function(){if(this instanceof m){var J=g(b.prototype),y=b.apply(J,c.concat(f.call(arguments)));return a(y)?y:J}return b.apply(d,c.concat(f.call(arguments)))};return m};var k,
u=Array.prototype.forEach;k=u&&n?function(a){u.apply(a,f.call(arguments,1))}:function(a,b,d){a=Object(a);for(var c=0,g=a.length>>>0;c<g;c++)c in a&&b.call(d,a[c],c,a)};b.forEach=k;var v=Array.prototype.filter;b.filter=v&&n?function(a){return v.apply(a,f.call(arguments,1))}:function(a,b,d){var c=[];k(a,function(a,g,m){b.call(d,a,g,m)&&c.push(a)});return c};var y,A=Array.prototype.map;y=A&&n?function(a){return A.apply(a,f.call(arguments,1))}:function(a,b,d){var c=[];k(a,function(a,g,m){c[g]=b.call(d,
a,g,m)});return c};b.map=y;var t=Array.prototype.indexOf;b.indexOf=t&&n?function(a){return t.apply(a,f.call(arguments,1))}:function(a,b,d){a=Object(a);var c=a.length>>>0,g=2<arguments.length?+d:0;0>g&&(g+=c,0>g&&(g=0));for(;g<c;g++)if(g in a&&b===a[g])return g;return-1};var p=Array.prototype.lastIndexOf;b.lastIndexOf=p&&n?function(a){return p.apply(a,f.call(arguments,1))}:function(a,b,d){a=Object(a);var c=a.length>>>0,g=2<arguments.length?+d:c;for(0>g?g+=c:g>c-1&&(g=c-1);0<=g;g--)if(g in a&&b===a[g])return g;
return-1};var z=Array.prototype.reduce;b.reduce=z&&n?function(a){return z.apply(a,f.call(arguments,1))}:function(a,b,d){a=Object(a);var c=a.length>>>0,g=0;if(2>=arguments.length){for(var m=!1;g<c;g++)if(g in a){d=a[g];g++;m=!0;break}if(!m)throw new TypeError("reduce: no initial value specified for empty array");}for(;g<c;g++)g in a&&(d=b.call(null,d,a[g],g,a));return d};var E=Array.prototype.reduceRight;b.reduceRight=E&&n?function(a){return E.apply(a,f.call(arguments,1))}:function(a,b,d){a=Object(a);
var c=(a.length>>>0)-1;if(2>=arguments.length){for(var g=!1;0<=c;c--)if(c in a){d=a[c];c--;g=!0;break}if(!g)throw new TypeError("reduceRight: no initial value specified for empty array");}for(;0<=c;c--)c in a&&(d=b.call(null,d,a[c],c,a));return d};var B=Array.prototype.every;b.every=B&&n?function(a){return B.apply(a,f.call(arguments,1))}:function(a,b,d){a=Object(a);for(var c=0,g=a.length>>>0;c<g;c++)if(c in a&&!b.call(d,a[c],c,a))return!1;return!0};var C=Array.prototype.some;b.some=C&&n?function(a){return C.apply(a,
f.call(arguments,1))}:function(a,b,d){a=Object(a);for(var c=0,g=a.length>>>0;c<g;c++)if(c in a&&b.call(d,a[c],c,a))return!0;return!1};c=Object.keys;b.keys=c&&n?c:function(a){var b=[],d;for(d in a)r(a,d)&&b.push(d);return b};var D=String.prototype.trim;b.trim=D&&n?function(a){return D.apply(a)}:function(a){if(!h(a))throw new TypeError("trim: str must be a string");return a.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")};b.addEventListener=function(a,b,d){a.addEventListener?a.addEventListener(b,d,
!1):a.attachEvent?a.attachEvent("on"+b,d):a["on"+b]=d};return b});k("localization-utils",[],function(){var c=/\{(\w+)\}/g;return{fillInStringTemplate:function(b,f){for(var e=b,a=c.exec(b);a;){var d=a[0],a=a[1];"string"===typeof f[a]&&(e=e.replace(d,f[a]));a=c.exec(b)}return e}}});k("clog",["lang"],function(c){function b(a){window.console&&window.console.error&&window.console.error(a)}function f(a){return window.Number(a)===a&&0===a%1}function e(a){return"[object String]"===Object.prototype.toString.call(a)}
function a(a){return!0===a||!1===a}function d(a,b){return window.JSON&&window.JSON.stringify?b+window.encodeURIComponent(window.JSON.stringify(a)):b+window.encodeURIComponent(a)}function h(a,b){return b+window.encodeURIComponent(a)}function q(a){a=a();e(a.name)&&"[object Function]"===Object.prototype.toString.call(a.send)&&"isPrimitive"in a&&(v[a.name]=a,++y)}function l(a,b){if(a){b=b||{};var c;if(c=!0===b.dontSendOnBFHit)c=window.ue&&"isBF"in window.ue?window.ue.isBF:(c=window.performance||window.webkitPerformance)&&
c.navigation?2===c.navigation.type:!1;if(!(c||a.length>E)){c=b.client&&b.client in v?b.client:k;try{v[c].send(a,C+D,d,b.chainedClientExecutionOrder)}catch(g){}}}}function n(a){var b;if(b=a)if(b="[object Array]"===Object.prototype.toString.call(a))if(b=0<a.length)if(b=a.length<y)a:{for(b=0;b<a.length;++b)if(!(a[b]in v)){b=!1;break a}else if(!v[a[b]].isPrimitive){b=!1;break a}b=!0}return b}function r(){return(new Date).getTime()}function w(){return window.PaymentsPortal2.widgetStartTime}var g={numberOfTimberLogCalls:0},
m=!1,s=!1,x=!1,k="consoleLoggingClient",u=["ajaxLoggingClient","imageLoggingClient","consoleLoggingClient"],v={},y=0,A={},t="requestId session marketplaceId marketplace service method client".split(" "),p={},z=function(){},E=1900,B=1E3,C="https://fls-devo.vipinteg.amazon.com/",D="/1/payments-portal-log/1/TOP/",F="/1/action-impressions/1/TOP/payments-portal/action/",G=!1,H="",I="";q(function(){function a(){if(window.XDomainRequest){var d=new window.XDomainRequest;d.onerror=z;d.ontimeout=z;d.onprogress=
z;d.onload=z;d.timeout=0;return d}if(window.XMLHttpRequest){d=new window.XMLHttpRequest;if(!("withCredentials"in d))throw"WithCredentials header not found Exception";return d}if(window.ActiveXObject){for(var c=0;c<b.length&&!d;c++)try{d=new window.ActiveXObject(b[c]),b=[b[c]]}catch(g){}return d}}var b="MSXML2.XMLHTTP.6.0 MSXML2.XMLHTTP.5.0 MSXML2.XMLHTTP.4.0 MSXML2.XMLHTTP.3.0 MSXML2.XMLHTTP Microsoft.XMLHTTP".split(" ");return{name:"ajaxLoggingClient",send:function(b,d,c){var g=a();if(!g)throw"unable to Create ajax object Exception";
b=c(b,d);g.open("GET",b,!0);g.send()},isPrimitive:!0}});q(function(){return{name:"imageLoggingClient",send:function(a,b,d){(new window.Image).src=d(a,b)},isPrimitive:!0}});q(function(){return{name:"consoleLoggingClient",send:function(a){if(window.console&&window.console.log)window.console.log(a);else throw"Cannot Find console.log";},isPrimitive:!0}});q(function(){return{name:"chainedLoggingClient",send:function(a,b,d,c){c=n(c)?c:u;for(var g=0;g<c.length;g++)try{return v[c[g]].send(a,b,d)}catch(m){}throw"Failed to send log message using chainedLoggingClient";
},isPrimitive:!1}});g.getClientNames=function(){var a=[],b;for(b in v)a.push(b);return a};g.setConfiguration=function(d){d=d||{};"isTimberLoggingOn"in d&&(a(d.isTimberLoggingOn)?m=d.isTimberLoggingOn:b("isTimberLoggingOn must be a boolean"));"isPmetLoggingOn"in d&&(a(d.isPmetLoggingOn)?x=d.isPmetLoggingOn:b("isPmetLoggingOn must be a boolean"));d.foresterEndpoint&&e(d.foresterEndpoint)&&(C=c.trim(d.foresterEndpoint));d.timberLoggingChannel&&(e(d.timberLoggingChannel)?D=d.timberLoggingChannel:b("timberLoggingChannel must be a string"));
d.pmetPostBackChannel&&(e(d.pmetPostBackChannel)?F=d.pmetPostBackChannel:b("pmetPostBackChannel must be a string"));d.defaultClient&&(d.defaultClient in v?k=d.defaultClient:b("Specified Client not found"));"maxTimberLogCalls"in d&&(f(d.maxTimberLogCalls)&&0<d.maxTimberLogCalls?B=d.maxTimberLogCalls:b("maxTimberLogCalls must be a integer > 0"));d.defaultChainedClientExecutionOrder&&(n(d.defaultChainedClientExecutionOrder)?u=d.defaultChainedClientExecutionOrder:b("defaultChainedClientExecutionOrder must be a array of strings with names exactly matching the exsisting clients; To know the client names use getClientNames() method"));
d.isSushiEelLoggingOn&&(a(d.isSushiEelLoggingOn)?G=d.isSushiEelLoggingOn:b("isSushiEelLoggingOn must be a boolean"));d.sushiEelEndPoint&&(e(d.sushiEelEndPoint)?H=d.sushiEelEndPoint:b("sushiEelEndPoint must be a string"));d.sushiEelSourceGroup&&(e(d.sushiEelSourceGroup)?I=d.sushiEelSourceGroup:b("sushiEelSourceGroup must be a string"))};g.setPmetHeaders=function(a){if(a){s=!1;for(var d=0;d<t.length;d++)if(t[d]in a)A[t[d]]=a[t[d]];else{b(t[d]+" is not found");return}s=!0}else b("PMET headers undefined")};
g.log=function(a,b){m&&(g.numberOfTimberLogCalls++,g.numberOfTimberLogCalls===B?l("Max number of Forester Logs Reached"):g.numberOfTimberLogCalls<B&&l(a,b))};g.logLatencyMetric=function(a){x&&s&&a&&a.feature&&e(a.feature)&&a.resource&&e(a.resource)&&(p[a.feature]=p[a.feature]||{},p[a.feature][a.resource]=p[a.feature][a.resource]||[],a.startTime=a.startTime||w(),a.unit=a.unit||"ms",p[a.feature][a.resource].push({value:r()-a.startTime,unit:a.unit}))};g.logCounterMetric=function(a){if(x&&s&&a&&a.feature&&
e(a.feature)&&a.resource&&e(a.resource)){p[a.feature]=p[a.feature]||{};p[a.feature][a.resource]=p[a.feature][a.resource]||[];var b;if(b="amount"in a)b=a.amount,b=f(b)&&0<=b;a.amount=b?a.amount:1;0===p[a.feature][a.resource].length?p[a.feature][a.resource].push({value:a.amount,unit:"Count"}):p[a.feature][a.resource][0].value+=a.amount}};g.publishMetrics=function(){if(x&&s)try{var a,b="",d;for(d in p)if(p.hasOwnProperty(d)){var b=b+("/"+d+":"),c;for(c in p[d])if(p[d].hasOwnProperty(c))for(var g=0;g<
p[d][c].length;++g)b+=c+"@v="+p[d][c][g].value,p[d][c][g].unit&&(b+="|u="+p[d][c][g].unit),b+=",";b=b.substring(0,b.length-1)}if(a=b){var m;if(s){b="";for(d=0;d<t.length-1;++d)b+=t[d]+"="+A[t[d]]+"&";m=b+=t[t.length-1]+"="+A[t[t.length-1]]}else m=void 0;a+="?"+m;v.chainedLoggingClient.send(a,C+F,h);p={}}}catch(y){}};g.getCurrentTime=r;g.getWidgetStartTime=w;g.publishSushiEelMetrics=function(a){if(G)try{var b=new window.XMLHttpRequest;if(!("withCredentials"in b))throw"WithCredentials header not found Exception";
b.open("POST",H+"1/events/"+I,!0);b.send(JSON.stringify({events:[{data:a}]}))}catch(d){}};return g});k("mash-helper",["AUI!P"],function(c){return{openInExternalBrowser:function(b,f,e){c.when("mash").execute(function(a){a.openInExternalBrowser({url:b,successCallback:f,failCallback:e})})},showEmbeddedBrowser:function(b,f,e,a,d,h){c.when("mash").execute(function(c){c.showEmbeddedBrowser({targetURL:b,method:f,postParameters:e,doneButtonCallback:h,successCallback:a,failCallback:d})})},navigateToUrl:function(b){c.when("mash").execute(function(c){c.navigate({url:b})})},
clearNavigationHistory:function(){c.when("mash").execute(function(b){b.navstack.clearHistory({})})}}});k("metrics-helper",["lang","jQuery","widget","component"],function(c,b,f,e){return{publishOnClickSuccessSushiMetrics:function(a,b){c.forEach(b,function(b){a.getDOMElement(b.JsBindElementId).click(function(){a.widget.publishSuccessSushiMetrics(b.MetricsObject)})},this)}}});k("modal-popover",["jQuery","base","AUI!P","clog"],function(c,b,f,e){return b.extend({initialize:function(a,b,c){this.widget=
a;this.popoverName=b.data.popoverName;this.declarativeAction=b.data.declarativeAction;this.closeEventName=b.data.closeEventName||this.popoverName+":close";this.bindToComponent(c)},bindToComponent:function(a){var b=this,c=a.bindToElements;a.bindToElements=function(){b.bindToElements.call(b);c.call(a)}},bindToElements:function(){var a=this,b=function(){a.widget.trigger(a.closeEventName)};f.when("A","a-modal").execute(function(c,f){var e=c.$("#"+a.declarativeAction);a.popoverInstance=f.get(e);a.popoverInstance.lock(100).show();
c.on("a:declarative:a-popover-close:click",b)});a.widget.on(a.closeEventName,a,function(){a.popoverInstance&&a.popoverInstance.isActive()&&(a._hidePopoverAndOff(b),a.widget.log({popoverCloseButtonClicked:!0}),e.logCounterMetric({feature:"PopoverCloseEvent",resource:"_Count"}))});a.widget.on("widget:clean",a,function(){var c=a.popoverInstance;c&&c.isActive()&&(delete c.typeSpecificFunctions.showMethod,delete c.typeSpecificFunctions.hideMethod,c=c.attrs("lightboxOptions"),c.showDuration=0,c.hideDuration=
0,a._hidePopoverAndOff(b))})},_hidePopoverAndOff:function(a){var b=this;b.popoverInstance.unlock(100).hide();f.when("a-modal").execute(function(a){a.remove(b.declarativeAction)});f.when("A").execute(function(b){b.off("a:declarative:a-popover-close:click",a)})}})});k("number-format",["base","lang"],function(c,b){var f={AUD:"$",BRL:"R$",CAD:"CDN$",CNY:"\u00a5",EUR:"\u20ac",GBP:"\u00a3",INR:"<span class='pmts-INR-currency-symbol'>&nbsp;&nbsp;</span>",JPY:"\u00a5",MXN:"$",RUB:"py6.",USD:"$"},e={AU:{fixedDecimalPrecision:2,
numberDelim:",",radix:"."},BR:{fixedDecimalPrecision:2,numberDelim:".",radix:","},CA:{fixedDecimalPrecision:2,numberDelim:",",radix:"."},CN:{fixedDecimalPrecision:2,numberDelim:",",radix:"."},DE:{fixedDecimalPrecision:2,numberDelim:".",radix:","},ES:{fixedDecimalPrecision:2,numberDelim:".",radix:","},FR:{fixedDecimalPrecision:2,numberDelim:".",radix:","},GB:{fixedDecimalPrecision:2,numberDelim:",",radix:"."},IT:{fixedDecimalPrecision:2,numberDelim:".",radix:","},IN:{fixedDecimalPrecision:2,numberDelim:",",
radix:"."},JP:{fixedDecimalPrecision:0,numberDelim:",",radix:"."},MX:{fixedDecimalPrecision:2,numberDelim:",",radix:"."},NL:{fixedDecimalPrecision:2,numberDelim:".",radix:","},RU:{fixedDecimalPrecision:2,numberDelim:".",radix:",",symbolAfterNumber:!0},US:{fixedDecimalPrecision:2,numberDelim:",",radix:"."}};return c.extend({SUPPORTED_COUNTRIES:b.keys(e),initialize:function(a,d){if(-1===b.indexOf(this.SUPPORTED_COUNTRIES,a))throw Error("The country provided is invalid or not supported.");d&&d.currency&&
!d.useCurrencyCode&&(d.currency=f[d.currency]);this.formatConfig=b.extend({},e[a],d)},format:function(a){var b=[],c=Number(a);if(null===a||""===a||isNaN(c))throw Error("The amount value is invalid. It must be represented as a decimal number in string format.");a=Math.abs(c);0>c&&b.push("- ");this.formatConfig.currency&&!this.formatConfig.symbolAfterNumber&&(b.push(this.formatConfig.currency),this.formatConfig.useCurrencyCode&&b.push(" "));for(var c=a.toFixed(this.formatConfig.fixedDecimalPrecision).split("."),
f=a=c[0].length,e;0<f;)e=(f-1)%3+1,b.push(c[0].substr(a-f,e)),f-=e,0<f&&b.push(this.formatConfig.numberDelim);0<this.formatConfig.fixedDecimalPrecision&&(b.push(this.formatConfig.radix),b.push(c[1]));this.formatConfig.currency&&this.formatConfig.symbolAfterNumber&&(b.push(" "),b.push(this.formatConfig.currency));return b.join("")},localizedParseNumber:function(a){if(b.isDefined(a)){a=a.split(this.formatConfig.radix);if(2<a.length)return NaN;var d=this.formatConfig.numberDelim,c=a[0].split(d);if(2>
c.length)d=a[0];else if(RegExp("^-{0,1}[1-9]{1,3}(\\"+d+"[0-9]{3})*$").test(a[0]))d=c.join("");else return NaN;return 1===a.length?Number(d):Number(d+"."+a[1])}return NaN}})});k("popover-base",["AUI!P","base","lang","jQuery"],function(c,b,f,e){return b.extend({auiOptions:null,customOptions:null,$elem:null,initialize:function(a,b,c){this.$elem=a;this.auiOptions=b;this.customOptions=f.extend({},c)},auiShow:function(a,b,c){var e=this;b=e._defaultValue(b,{});c=e._defaultValue(c,!1);e._auiDefined(function(l){l&&
(c&&(e.auiOptions={}),b=f.extend({},e.auiOptions,b),a?e._auiSet(e.$elem,b):e._auiRemove(e.$elem))})},customShow:function(a,b,c){var e=this;b=e._defaultValue(b,{});c=e._defaultValue(c,!1);e._auiDefined(function(l){l||(c&&(e.customOptions={}),b=f.extend({},e.customOptions,b),a?e._customSet(e.$elem,b):e._customHide(e.$elem))})},_auiSet:function(a,b){c&&this.componentName&&c.when("A",this.componentName).execute(function(c,e){var f=e.get(a);f?f.update(b):e.create(a,b)})},_auiDefined:function(a){c&&c.when("A",
this.componentName).execute(function(b,c){a("undefined"!==typeof c)})},_auiRemove:function(a){c&&this.componentName&&c.when("A",this.componentName).execute(function(b,c){c.remove(a)})},_customSet:function(a,b){c&&c.when("A","a-popover-base").execute(function(c,f){var l=f.get(a);l||(l=f.show({$trigger:a,skin:function(a){return['<div class="a-popover"><div class="a-popover-wrapper">','<div class="a-popover-inner">'+a+"</div>",'<div class="a-arrow-border"><div class="a-arrow"></div></div></div></div>'].join("")},
alone:!1,update:function(a){e(".a-popover-inner",this.$popover).html(a)},content:b.literalContent,position:b.position||"triggerLeft"}));l&&(l.update(b.literalContent),l.updatePosition())})},_customHide:function(a){c&&c.when("A","a-popover-base").execute(function(b,c){c.hide(a)})},_defaultValue:function(a,b){return"undefined"!==typeof a?a:b}})});k("popover",["popover-base"],function(c){return c.extend({componentName:"a-popover"})});k("public-event-registry",["lang"],function(c){var b=[];return{register:function(f){var e=
this;c.forEach(arguments,function(a){c.isString(a)&&!e.has(a)&&b.push(a)})},has:function(f){return c.isString(f)&&0<=c.indexOf(b,f)}}});k("security",["base","clog","config","jQuery"],function(c,b,f,e){function a(a){a=a.not('[name^="ppw-"]').filter(function(){return this.value&&""!==this.value.trim()});for(var b=0;b<k.length;++b)a=a.not('[name="'+k[b]+'"]');return a}function d(c){return function(){a(c.getRootDOMElements().find("input")).each(function(a,c){var d=e(c).attr("name");b.logCounterMetric({feature:"sec.exf.",
resource:d,amount:h})});b.publishMetrics()}}var h=f.getAttribute("securePage")?0:1,k=["ie"];return c.extend({initialize:function(a){var b=d(a);a.getRootDOMElements().find(":button,:submit").bind("click",b)}})});k("server",["jQuery","lang","clog"],function(c,b,f){function e(a,c,d){c in a&&(a[c]=b.bind(a[c],d))}function a(a){var c=[];b.forEach(a,function(a){null!=a&&c.push(d(a))});return c}function d(c){if(b.isArray(c))return a(c);if(b.isObject(c)){var e={},g;for(g in c){var m=c[g];null!=m&&(e[g]=d(m))}return e}return c}
function h(a){var c=b.extend({},l,a);c.data=d(a.data);c.fatal||(c.fatal=b.NOOP);c.error||(c.error=function(a,b){n&&"error"===b||c.fatal()});c.headers=b.extend(c.headers,{"Widget-Ajax-Attempt-Count":0});null==c.metricOperation&&(c.metricOperation=c.type);return c}function k(a){var d=0,g=500+Math.floor(500*Math.random());b.has(a,"retryLimit")||(a.retryLimit=2);var m=function(a){return 0===a?g:1E3*Math.pow(2,a)},e=a.retryDelayFn?a.retryDelayFn:m,f=a.error;return function(g,m){var h=500<=g.status&&600>
g.status||408===g.status||"timeout"===m||0===g.status&&0===g.readyState;401===g.status?a.fatal({type:"auth"}):!h&&f?f.apply(this,arguments):h&&d<a.retryLimit?(h=e(d),d++,a.headers=b.extend(a.headers,{"Widget-Ajax-Attempt-Count":d}),window.setTimeout(function(){c.ajax(a)},h)):d>=a.retryLimit&&f&&f.apply(this,arguments)}}var l={contentType:"application/x-www-form-urlencoded; charset=UTF-8",dataType:"json",cache:!1,globals:!1,timeout:3E4},n=!1;c(window).bind("beforeunload",function(){n=!0});return{ajax:function(a){var b=
f.getCurrentTime();n=!1;a=h(a);this._addInterceptHandlers(a,b);if(b=a.context)delete a.context,e(a,"beforeSend",b),e(a,"success",b),e(a,"error",b),e(a,"complete",b);if(b=a.query){var d=-1===a.url.indexOf("?")?"?":"&";a.url+=d+c.param(b,!0)}a.error=k(a);a.xhrFields={withCredentials:!0};return c.ajax(a)},_addInterceptHandlers:function(a,c){b.time();b.intercept(a,"error",function(b,c,d){a.data&&a.data["ppw-widgetEvent"]&&f.logCounterMetric({feature:a.data["ppw-widgetEvent"],resource:"_ErrorCount"})},
this);b.intercept(a,"complete",function(){b.time();a.data&&a.data["ppw-widgetEvent"]&&(f.logCounterMetric({feature:a.data["ppw-widgetEvent"],resource:"_Count"}),f.logLatencyMetric({feature:a.data["ppw-widgetEvent"],resource:"_Latency",startTime:c}))},this);b.intercept(a,"success",function(){a.data&&a.data["ppw-widgetEvent"]&&f.logCounterMetric({feature:a.data["ppw-widgetEvent"],resource:"_SuccessCount"})},this)}}});k("testAjaxCapability",["clog"],function(c){return{makeCall:function(b){var c=this,
e=b.options.clientId+"_testAjaxCapability";b.continueRequest({"ppw-widgetState":b.options.serializedState},{success:function(a){c.logMetric(e,0)},error:function(a){c.logMetric(e,1)},fatal:function(a){c.logMetric(e,1)}})},logMetric:function(b,f){c.logCounterMetric({feature:b,resource:"_Count",amount:f})}}});k("tooltip",["popover-base"],function(c){return c.extend({componentName:"a-tooltip"})});k("validation-functions",["lang","number-format"],function(c,b){var f=function(a){if(!a||0===a.length)return!1;
for(var b=0,c=!1,d=a.length-1;0<=d;--d){var e=a.charAt(d);c&&(e*=2,9<e&&(e-=9));b+=parseInt(e,10);c=!c}return 0===b%10},e=function(a,b){return c.some(b,function(b){return a.test(b)})},a=function(a){return c.some(a,function(a){return a&&""!==c.trim(a)})},d=function(a,d){if(void 0!==a&&null!==a&&!0!==a&&!1!==a&&""!==c.trim(a)){var e=(new b(d)).localizedParseNumber(a);return isNaN(e)?null:e}return null},h=function(a){return a&&null!==a.match(/^[0-9]+$/)},k=function(a){a=a.getAdditionalData("isMbccFn");
return c.isFunction(a)&&a()},l=function(a){var b=/^\d{3,4}$/;"AmericanExpress"===a?b=/^\d{4}$/:a&&(b=/^\d{3}$/);return b},n=function(a,b){return!b.fieldRequiredParameterName||"true"===a[b.fieldRequiredParameterName]},r=function(a,b,c){var d="";void 0!==a&&(d=a);a=b[c.defaultParameterName];return void 0!==a&&(a=a&&a.replace(/-|\s/g,""),4<=a.length)?a.substr(a.length-d.length)===d:!1},w={NonEmptyFieldConstraint:function(a,b,d){a=b[d.defaultParameterName];return void 0!==a&&""!==c.trim(a)},RegexMatchFieldConstraint:function(a,
b,c,d){return RegExp(d.pattern).test(b[c.defaultParameterName])},NonEmptyComplexFieldConstraint:function(b,c,d){return a([c[d.defaultParameterName],c[d.radioButtonName],c[d.dropdownName]])},NumericCustomAmountRewardsAccountSelectionFieldConstraint:function(a,b,e,f){a=f.locale.substring(3);return c.isDefined(d(b[e.customAmountSelectionInput],a))},CustomAmountLessThanOrEqualToMaxUsableRewardsAccountSelectionFieldConstraint:function(a,b,e,f){a=b[e.customAmountSelectionInput];b=f.locale.substring(3);
a=d(a,b);return c.isDefined(a)&&a<=Number(f.maxUsableAmount)},CustomAmountLargerThanOrEqualToMinUsableRewardsAccountSelectionFieldConstraint:function(a,b,e,f){a=b[e.customAmountSelectionInput];b=f.locale.substring(3);a=d(a,b);return c.isDefined(a)&&a>=Number(f.minUsableAmount)},LengthBetweenConstraint:function(a,b,c,d){a=b[c.defaultParameterName];return a.length>=d.min&&a.length<=d.max},LengthLessThanEqualConstraint:function(a,b,c,d){return b[c.defaultParameterName].length<=d.maximumLength},LengthGreaterThanEqualConstraint:function(a,
b,c,d){return b[c.defaultParameterName].length>=d.minimumLength},LengthEqualToConstraint:function(a,b,c,d){a=b[c.defaultParameterName];return void 0!==a&&a.length===d.expectedLength},IsNumberFieldConstraint:function(a,b,d){a=b[d.defaultParameterName];return void 0!==a&&null!==a&&!0!==a&&!1!==a&&!isNaN(a-0)&&""!==c.trim(a)},GreaterThanEqualFieldConstraint:function(a,b,c,d){return b[c.defaultParameterName]>=d.min},LessThanEqualFieldConstraint:function(a,b,c,d){return b[c.defaultParameterName]<=d.max},
CreditCardExpirationConstraint:function(a,b,c,d){a=b[c.combinedMonthYearParameterName];var e,f;a?(c=a.split("/"),2===c.length&&(e=parseInt(c[0].trim(),10),f=parseInt("20"+c[1].trim(),10))):(e=parseInt(b[c.monthParameterName],10),f=parseInt(b[c.yearParameterName],10));if(isNaN(e)||isNaN(f))return!1;c=new Date(b.widgetCreationEpochMilliseconds);b=c.getUTCFullYear();c=c.getUTCMonth();return f>b&&f<=b+20||f===b&&e>=c+1},ValidCreditCardSecurityCodeConstraint:function(a,b,d){if(!n(b,d))return!0;var e=a.getAdditionalData("isCvvForMbcc");
b=b[d.defaultParameterName];d=/^\d{3,4}$/;e?d=k(a)?/^\d{3,8}$/:/.*?/:(a=a.getAdditionalData("issuerFn"),a=c.isFunction(a)?a():"",d=l(a));return d.test(c.trim(b))},ValidAmexCreditCardSecurityCodeConstraint:function(a,b,d){if(!n(b,d))return!0;b=b[d.defaultParameterName];a=a.getAdditionalData("issuerFn");return"AmericanExpress"===(c.isFunction(a)?a():"")?/^\d{4}$/.test(c.trim(b)):!0},SelectableListValidCreditCardSecurityCodeConstraint:function(a,b,d,e){a=b[d.defaultParameterName];return l(e.issuer).test(c.trim(a))},
ValidCreditCardNumberTailConstraint:function(a,b,c){return r(a.getAdditionalData("creditCardTail"),b,c)},ValidBankAccountNumberTailConstraint:function(a,b,c){return r(a.getAdditionalData("accountNumberTail"),b,c)},ValidCreditCardNumberConstraint:function(a,b,d){a=a.getAdditionalData("isSBIMaestroFn");a=c.isFunction(a)?a():!1;b=(b=b[d.defaultParameterName])&&b.replace(/-|\s/g,"");return a?19===b.length&&f(b):11<=b.length&&19>=b.length&&f(b)},ValidEBTCardNumberConstraint:function(a,b,d){var e=(a=b[d.defaultParameterName])&&
a.replace(/-|\s/g,"");a=c.some(["600486","507714","507712"],function(a){return c.startsWith(e,a)})?h:f;return 16<=e.length&&19>=e.length&&a(e)},MatchValuesJSOnlyConstraint:function(a,b,c,d){a=b[c.defaultParameterName];b=b[d.targetFieldParameterName];return void 0!==a&&void 0!==b&&a===b},DirectDebitPrefixNotContainsDigitsConstraint:function(a,b,c,d){a=b[c.defaultParameterName];d=d.lengthParameter;return void 0!==a&&null!==a&&null===a.substring(0,d).match(/\d+/g)},BusinessTaxIDConstraint:function(a,
b,c,d){d=b[c.defaultParameterName];return w.NonEmptyFieldConstraint(a,b,c)&&2>=d.replace(/[^-]/g,"").length&&9===d.replace(/[-]/g,"").length&&/^\d+$/.test(d.replace(/[-]/g,""))},InvoiceBirthdateConstraint:function(a,b,c,d){a=parseInt(b[c.monthParameterName],10)-1;d=parseInt(b[c.dayParameterName],10)-1;c=parseInt(b[c.yearParameterName],10);var e=new Date(b.widgetCreationEpochMilliseconds);b=e.getUTCFullYear()-18;var f=e.getUTCMonth(),e=e.getUTCDate();return a||d||c?b>c||b===c&&f>a||b===c&&f===a&&e>=
d:!0},ValidPhoneNumberConstraint:function(a,b,d,e){return k(a)?(a=b[d.defaultParameterName],e=RegExp(e.pattern),!!a&&e.test(c.trim(a.replace(/[\s\(\)\-]/g,"")))):!0},ValidCreditCardPostalCodeConstraint:function(a,b,c,d){if(!n(b,c))return!0;a=b[c.defaultParameterName];d=RegExp(d.pattern);return!!a&&d.test(a)},ValidVirtualPrivateAddressConstraint:function(a,b,c){return(a=b[c.defaultParameterName])&&a.match(/^([a-zA-Z0-9\.\-]+)([@]{1})([a-zA-Z0-9\-\.]+){1,255}$/)},RequiredNonEmptyConstraint:function(a,
b,c){return n(b,c)?w.NonEmptyFieldConstraint(a,b,c):!0},RequiredValidDateConstraint:function(a,b,c,d){if(!n(b,c))return!0;a=b[c.defaultParameterName];b=d.separator;if(RegExp(d.pattern).test(a))if(b=a.split(b),d=parseInt(b[0],10),a=parseInt(b[1],10),b=parseInt(b[2],10),1E3>b||3E3<b||0===a||12<a)d=!1;else{c=[31,28,31,30,31,30,31,31,30,31,30,31];if(0===b%400||0!==b%100&&0===b%4)c[1]=29;d=0<d&&d<=c[a-1]}else d=!1;return d},ContainsOnlyDigitsConstraint:function(a,b,c){return h(b[c.defaultParameterName])},
ValidCreditCardCurrencyCodeConstraint:function(a,b,c,d){return n(b,c)?e(RegExp(d.pattern),[b[c.defaultParameterName],b[c.radioButtonName],b[c.dropdownName]]):!0}};return w});k("widget-factory",["widget","lang","config","clog","testAjaxCapability"],function(c,b,f,e,a){function d(b,d,e,f,m){b=new c(b,d,e,f,m,function(b){k(b);"true"===b.options.testAjaxAuthenticationRequired&&a.makeCall(b)});h(b);return l[d.widgetInstanceId]=b}function h(a){e.logLatencyMetric({feature:"Widget",resource:"_Latency"});
a.log({WidgetCreationTime:e.getCurrentTime()-e.getWidgetStartTime()})}function k(a){var c=a.publicProxy();f.getAttribute("onWidgetCreated")&&b.forEach(f.getAttribute("onWidgetCreated"),function(a){a(c)})}var l={};return{_widgets:l,create:function(a,b,c,e,f){var h=l[b.widgetInstanceId];h&&h.continueRequestAjaxSubstitutionEnabled?h.setup(b,c,e,f):h=d(a,b,c,e,f);return h}}});k("widget","base lang when jQuery attributes server form-helper events/form-submitted-event clog public-event-registry events/spinner-events continuable AUI!P global-event-bus events security".split(" "),
function(c,b,f,e,a,d,h,k,l,n,r,w,g,m,s,x){var K=["sif_profile"];a=c.extend(w,{initialize:function(a,b,c,d,e,f){this.type=a;if(!b.widgetInstanceId)throw Error("widgetInstanceId is required.");this.widgetInstanceId=b.widgetInstanceId;this.widgetAjaxUrlPrefixPath=b.widgetAjaxUrlPrefix?b.widgetAjaxUrlPrefix:"";this.widgetRequestPrefixPath=b.widgetRequestPrefix?b.widgetRequestPrefix+"/":"";this.setup(b,c,d,e,f,!0)},setup:function(a,b,c,d,e,f){this.off(null,this);this.offAui();m.off("AuthTimeout");s.off("AuthTimeout");
this.continueRequestAjaxSubstitutionEnabled=void 0!==a.continueRequestAjaxSubstitutionEnabled?!!a.continueRequestAjaxSubstitutionEnabled:!!this.continueRequestAjaxSubstitutionEnabled;this.components={};this.continueRequestQueue=new v;this.widgetCreationEpochMilliseconds=d;this._localizationStringsMap=c;this.pageScrolled=!1;this.options=a;this.security=new x(this);this._registerWidgetPublicEvents();e&&e(this);this.serverToClientClockDifference=this.widgetCreationEpochMilliseconds-Date.now();this.clientSideRequestTimeOffset=
0;0<this.serverToClientClockDifference?this.clientSideRequestTimeOffset=this.serverToClientClockDifference:-12E4>this.serverToClientClockDifference&&(this.clientSideRequestTimeOffset=this.serverToClientClockDifference);0!==this.clientSideRequestTimeOffset&&f&&this.publishSuccessSushiMetrics({ActionType:"ClientSideRequestTimeOffsetEvent",ActionValueType:"ClientSideRequestTimeOffset",ActionValue:this.clientSideRequestTimeOffset});this.on("AuthTimeout",this,function(a){window!==window.parent&&window.parent.PaymentsPortal2&&
window.parent.PaymentsPortal2.modules&&(window.parent.PaymentsPortal2.modules.when(["global-event-bus"],function(b){b.trigger("AuthTimeout",a)}),window.parent.PaymentsPortal2.modules.when(["events"],function(b){b.trigger("AuthTimeout",a)}))});m.on("AuthTimeout",this,function(a){this.trigger("AuthTimeout",a)});this._initializeComponents(b)},getLocalizedString:function(a,c){var d=this._localizationStringsMap[a]||"";c&&(d=b.keywordFormat(d,c));return d},publicProxy:function(){var a=this;return a._proxy?
a._proxy:a._proxy={type:a.type,on:function(b,c){a.onPublicEvent(b,c)},update:function(b){a.trigger("UpdateWidget",b)},complete:function(){a.trigger("CompleteWidget")},isContinuable:function(){return a.getContinuable()}}},onPublicEvent:function(a,b){var c=this;c.on(a,c.publicProxy(),function(){n.has(a)||c.log({publicEventConsumedButNotRegistered:a});return b.apply(c.publicProxy(),arguments)})},submitFormAJAX:function(a,c){var d=this,f;a instanceof e?(f=h.serializeObject(a),c=c||{},c.queryParameters=
this._whitelistedQueryParameters(a.get(0).action)):f=a;f["ppw-widgetState"]&&0!==f["ppw-widgetState"].trim().length?(d.trigger("submitFormAjaxStarted"),d.continueRequest(f,b.extend({},c,{success:d.createAjaxContinueSuccessHandler(c?c.success:null),complete:function(){d._fixDropdown();d.trigger("submitFormAjaxCompleted")}}))):(this.trigger(r.hideSpinner),this.fatal({type:"error",reason:"Widget state is missing in form data",feature:"MissingWidgetState"}))},_whitelistedQueryParameters:function(a){var c=
{};if(!a||-1===a.indexOf("?"))return c;a=a.substring(a.indexOf("?")+1);b.forEach(a.split("&"),function(a){a=a.split("=");0<=b.indexOf(K,a[0])&&(c[a[0]]=a[1])});return c},createAjaxContinueSuccessHandler:function(a){var c=this;return function(d){c._onAJAXContinueSuccess(d);a&&b.isFunction(a)&&a.apply(c,arguments)}},continueRequest:function(a,c){c=c?b.extend({},c):{};c.data=b.extend({},c.data?c.data:{},{"ppw-jsEnabled":!0},a);this.continueRequestQueue.enQueue(new u(this.options.customerId,c,this));
this._processContinueRequestQueue()},fatal:function(a){a=a||{type:"error"};var b="auth"===a.type?"AuthTimeout":"Fatal",c=a.feature||"AjaxContinue";"Fatal"===b&&(this.log({ajaxFatal:a}),l.logCounterMetric({feature:c,resource:"_ErrorCount"}),l.publishMetrics());this.trigger(b,a)},widgetAction:function(a){this.trigger("WidgetAction",a)},width:function(){var a=this.getRootDOMElements(),c=0,d;b.forEach(a,function(a){d=e(a);(a=d.outerWidth())&&a>c&&(c=a)});return c},height:function(){var a=this.getRootDOMElements(),
c=0,d;b.forEach(a,function(a){d=e(a);(a=d.outerHeight())&&(c+=a)});return c},scrollToElementOnInitialize:function(a){this.pageScrolled||(this.scrollToElement(e("#"+a)),this.pageScrolled=!0)},scrollToElement:function(a){a&&0<a.length&&e("html, body").animate({scrollTop:a.offset().top},"fast")},focusToElement:function(a){e("#"+a).focus()},scrollToTopOfThePage:function(){this.pageScrolled||(this.forceToScrollToTopOfThePage(),this.pageScrolled=!0)},forceToScrollToTopOfThePage:function(){e("html, body").scrollTop(0)},
_initializeComponents:function(a){var c=this,d=b.map(a,function(a){return"components/"+a.type});f(d,function(){b.forEach(arguments,function(b,d){var e=a[d],f=new b(c,e);return c.components[e.id]=f});c._onComponentsInitialized()})},_registerWidgetPublicEvents:function(){n.register("AuthTimeout","Done","Fatal",k,r.showSpinner,r.hideSpinner,"WidgetAction")},_onComponentsInitialized:function(){var a=this;e("document").ready(function(){b.forEachKeyValue(a.components,function(a,b){b.initializeOnReady()});
a._setupFormHandling();a.trigger("componentsInitialized")})},_setupFormHandling:function(){var a=this.getRootDOMElements();h.onSubmit(a.find("form").andSelf().filter("form"),b.bind(this._onFormSubmission,this))},_onFormSubmission:function(a,b,c){this.ajaxSubstitutionEnabled(a)?this._onAJAXFormSubmission(a,b,c):this._onStandardFormSubmission(a,b,c)},_onStandardFormSubmission:function(a,b,c){},_onAJAXFormSubmission:function(a,b,c){if(!b.isDefaultPrevented()){b.preventDefault();b={};if(c){var d=c.get(0).name;
""!==d&&(b[d]=c.val())}this.submitFormAJAX(a,{data:b})}},ajaxSubstitutionEnabled:function(a){a=a.get(0).getAttribute("data-pmts-ajax-continuation");return this.continueRequestAjaxSubstitutionEnabled&&(null==a||"true"===a)},setAjaxSubstitutionEnabled:function(a,b){a.attr("data-pmts-ajax-continuation",b)},_onAJAXContinueSuccess:function(a){a.htmlContent&&this._swapHtmlAndEval(a.htmlContent)},_resumeContinueRequestQueue:function(){this.processingContinueRequest=!1;this._processContinueRequestQueue()},
_processContinueRequestQueue:function(){!this.processingContinueRequest&&0<this.continueRequestQueue.length()&&this._processContinueRequest(this.continueRequestQueue.deQueue())},_processContinueRequest:function(a){this.processingContinueRequest=!0;l.publishMetrics();return d.ajax(a.options)},_handleContinueSuccess:function(a){a&&a.htmlChunks&&a.componentDataList||this.fatal();this._updateWidgetHtml(a.htmlChunks);this._attachNewComponents(a.componentDataList);this._resumeContinueRequestQueue()},_handleContinueError:function(){this.fatal()},
_attachNewComponents:function(a){var c=[];b.forEach(a,function(a){c.push(e.parseJSON(a))});this._initializeComponents(c)},_updateWidgetHtml:function(a){var c=this;b.forEachKeyValue(a,function(a,b){c._updateComponentDOM(a,b)})},_updateComponentDOM:function(a,b){var c=this.components[a];c&&(c=c.getRootDOMElements(),this._deleteComponentsInDOM(c),this._deleteComponent(a),c.first().before(b).end().remove())},_deleteComponentsInDOM:function(a){var b=this;a.find("[data-pmts-component-id]").each(function(a,
c){var d=e(c).attr("data-pmts-component-id");b._deleteComponent(d)})},_removeWidgetComponents:function(){var a=this;a.trigger("widget:clean");b.forEachKeyValue(a.components,function(b,c){c&&(c.detach(),delete a.components[b],c.getRootDOMElements().remove())})},_removeDropdownPopovers:function(){g.when("a-popover-base").execute(function(a){e(".pmts-portal-component .a-dropdown-container").each(function(){a.remove(e(this).find("select").attr("name"))})})},_deleteComponent:function(a){var b=this.components[a];
b&&(b.detach(),delete this.components[a])},getRootDOMElements:function(){return e(".pmts-portal-root-"+this.widgetInstanceId)},_getWidgetDOMAppender:function(){var a=this.getRootDOMElements();if(0===a.length)throw Error("Could not find the root dom elements of the widget in order to append new content.");var a=a.get(a.length-1),c=a.nextSibling,d=a.parentNode,e=null,e=c?function(a){d.insertBefore(a,c)}:function(a){d.appendChild(a)};return function(a){b.forEach(a,e)}},_fixDropdown:function(){var a=
this.getRootDOMElements(),b=a.find("select.a-native-dropdown").not("[data-action=a-dropdown-select]");b.length&&(a.find(".a-button-dropdown").attr("aria-hidden",!0).find(".a-button-text").removeAttr("tabindex"),b.attr({tabindex:0,"data-action":"a-dropdown-select"}).addClass("a-declarative"))},_swapHtmlAndEval:function(a){var c=[],d=[];e(a).each(function(a,b){1===b.nodeType?e(b).is("style")||(e(b).is("script:not([src])")?d.push(b):c.push(b)):c.push(b)});e(".apx-secondary-view-root-"+this.widgetInstanceId).remove();
a=this._getWidgetDOMAppender(this);this._removeWidgetComponents();this._removeDropdownPopovers();this.getRootDOMElements().remove();0<c.length&&(a(c),b.forEach(d,function(a){e.globalEval(e(a).html())}))},log:function(a){a=b.extend({customerId:this.options.customerId,widgetInstanceId:this.options.widgetInstanceId,sessionId:this.options.sessionId},a);l.log(a)},_generateWidgetRequestHeaders:function(){return{"APX-Widget-Info":[this.options.clientId,this.options.deviceType,this.options.widgetInstanceId].join("/")}},
_publishSushiMetrics:function(a){var b={ActionResult:a.ActionResult,PageLocale:this.options.locale,CustomerId:this.options.customerId,WidgetInstanceId:this.options.widgetInstanceId,WidgetDeviceType:this.options.deviceType,WidgetName:this.type,MarketplaceId:this.options.marketplaceId,Session:this.options.sessionId,PortalClientId:this.options.clientId,StartTime:Date.now()+this.clientSideRequestTimeOffset};b.RequestId=this.options.requestId?this.options.requestId:this.options.widgetInstanceId;var c=
{ActionType:null,ActionValueType:"Unspecified",ActionValue:null,ActionParentValueType:"Unspecified",ActionParentValue:null,ActionErrorCode:null},d;for(d in c)a[d]?b[d]=a[d]:c[d]&&(b[d]=c[d]);l.publishSushiEelMetrics(b)},publishFailureSushiMetrics:function(a){a.ActionResult="Failure";this._publishSushiMetrics(a)},publishSuccessSushiMetrics:function(a){a.ActionResult="Success";this._publishSushiMetrics(a)}});var u=c.extend({initialize:function(a,c,d){a=b.keywordFormat("{widgetAjaxUrlPrefixPath}/payments-portal/data/{widgetRequestPrefixPath}widgets2/v1/customer/{customerId}/continueWidget",
{customerId:a,widgetAjaxUrlPrefixPath:d.widgetAjaxUrlPrefixPath,widgetRequestPrefixPath:d.widgetRequestPrefixPath});if(c.queryParameters){var e=[];b.forEachKeyValue(c.queryParameters,function(a,b){e.push(encodeURIComponent(a)+"="+encodeURIComponent(b))});0<e.length&&(a=a+"?"+e.join("&"))}this.options=b.extend({},{type:"POST",url:a,success:b.bind(d._handleContinueSuccess,d),error:b.bind(d._handleContinueError,d),fatal:b.bind(d.fatal,d)},c);this.options.headers=b.extend({},this.options.headers,d._generateWidgetRequestHeaders());
c=function(a,b,c){return b||c&&"undefined"===typeof b?function(b,c){try{a(b,c)}finally{d._resumeContinueRequestQueue()}}:a};this.options.success=c(function(a){return function(c,e){if(c&&c.additionalWidgetResponseData){var f=c.additionalWidgetResponseData.additionalData;if(f){if("true"===f.widgetDone){var g={};b.forEachKeyValue(f,function(a,b){try{var c=JSON.parse(b);g[a]="boolean"===typeof c?b:c}catch(d){g[a]=b}});"SetPaymentPlanSelect"===d.type?d.trigger("Done",f):d.trigger("Done",g)}f.widgetAction&&
d.widgetAction(f)}}a(c,e)}}(this.options.success),this.options.resumeContinueQueueOnSuccess,!0);this.options.error=c(this.options.error,this.options.resumeContinueQueueOnError,!0);this.options.fatal=c(this.options.fatal,this.options.resumeContinueQueueOnFatal,!0)}}),v=c.extend({initialize:function(){this.items=[]},enQueue:function(a){this.items.push(a)},deQueue:function(){return this.items.shift()},length:function(){return this.items.length}});return a});k("workflow-component",["component","lang",
"public-event-registry","events/workflow-state-event"],function(c,b,f,e){return c.extend({_workflowState:void 0,initialize:function(a,b){this._workflowState=b.data.workflowState;f.register(e)},bindToEvents:function(){var a=this;a.widget.on("componentsInitialized",a,function(b){a.widget.trigger(e,a._workflowState)})}})})})();
